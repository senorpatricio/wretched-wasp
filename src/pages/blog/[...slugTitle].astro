---
// import { type CollectionEntry, getCollection } from "astro:content";
import CarPost from "../../layouts/CarPost.astro";
import { GraphQLClient } from 'graphql-request';
import MarkdownPostLayout from "../../layouts/MarkdownPostLayout.astro";


type CarPage = {
	car: {
		title: string;
		slugTitle: string;
		pubDate: Date;
		description: string;
	};
};

export async function getStaticPaths() {

	const client = new GraphQLClient(import.meta.env.HYGRAPH_ENDPOINT);

	const carsQuery = `query MyQuery {
		cars {
			title
			slugTitle
			description
			make
			model
			year
			country
			carMainImage {
				url
			}
			article {
				markdown
			}
		}
	}`;

	const cars = await client.request(carsQuery);
	// console.log('cars: ', cars.cars)
	return cars.cars.map( car => ({
		params: { 
			slugTitle: car.slugTitle 
		},
		props: { car }
	})  )
	
}

const { car } = Astro.props;

---
<!-- <CarPost {...car}>
</CarPost> -->

<MarkdownPostLayout {car}/>